<?xml version="1.0"?>
<project name="org.eclipse.emf.compare.doc" default="default">
  <property name="src.dir" value="${basedir}/src"/>
  <property name="lib.dir" value="${basedir}/lib"/>
  <property name="build.dir" value="${basedir}/target"/>
  <property name="classes.dir" value="${build.dir}/classes"/>
  <fileset dir="${lib.dir}" id="compare-gendoc.jars">
    <include name="org.eclipse.jgit-3.2.0.201312181205-r.jar"/>
    <include name="org.eclipse.mylyn.wikitext.core_1.9.0.20131007-2055.jar"/>
    <include name="org.eclipse.mylyn.wikitext.mediawiki.core_1.9.0.20131007-2055.jar"/>
  </fileset>
  <path id="classpath">
    <fileset refid="compare-gendoc.jars"/>
    <pathelement location="${classes.dir}"/>
    <pathelement location="${src.dir}"/>
  </path>
  <target name="clean" description="remove all generated files">
    <delete dir="${build.dir}"/>
  </target>
  <!--
 Default target so that a command line build can 
       do more than one thing. 
-->
  <target name="default" depends="jar"/>
  <target name="compile" description="compile Java source code">
    <mkdir dir="${classes.dir}"/>
    <javac destdir="${classes.dir}" classpathref="classpath" debug="on" deprecation="on" includeAntRuntime="no" encoding="UTF-8">
      <src path="${src.dir}"/>
      <compilerarg value="-Xlint:rawtypes"/>
      <compilerarg value="-Xlint:unchecked"/>
    </javac>
  </target>
  <target name="jar" depends="compile" description="build compare-gendoc.jar">
    <jar destfile="${build.dir}/compare-gendoc.jar" update="true">
      <zipfileset refid="compare-gendoc.jars"/>
      <zipfileset src="${lib.dir}/jar-in-jar-loader.zip"/>
      <fileset dir="${src.dir}" excludes="**/*.java"/>
      <fileset dir="${classes.dir}"/>
      <manifest>
      	<attribute name="Main-Class" value="org.eclipse.jdt.internal.jarinjarloader.JarRsrcLoader"/>
      	<attribute name="Rsrc-Main-Class" value="org.eclipse.emf.compare.doc.WikiTextToHTML"/>
      	<attribute name="Class-Path" value="."/>
      	<attribute name="Rsrc-Class-Path" value="./ org.eclipse.jgit-3.2.0.201312181205-r.jar org.eclipse.mylyn.wikitext.core_1.9.0.20131007-2055.jar org.eclipse.mylyn.wikitext.mediawiki.core_1.9.0.20131007-2055.jar"/>
      </manifest>
    </jar>
  </target>
  <target name="all" depends="jar"/>
</project>
